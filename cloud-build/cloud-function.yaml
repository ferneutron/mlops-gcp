steps:
- id: "Deploy-CloudFunction"
  name: 'gcr.io/google.com/cloudsdktool/cloud-sdk:475.0.0'
  env:
    - '_PIPELINE=$_PIPELINE'
    - '_LOCATION=$_LOCATION'

  script: |
    #!/usr/bin/env bash
    gcloud functions deploy cf-${_PIPELINE} \
        --gen2 \
        --runtime=python312 \
        --region=${_LOCATION} \
        --source=cloud-functions/${_PIPELINE} \
        --entry-point=run_${_PIPELINE}_pipeline \
        --trigger-http \
        --memory=512 \
        --timeout=300
        --service-account=workshop@gsd-ai-mx-ferneutron.iam.gserviceaccount.com

options:
  automapSubstitutions: true
  logging: CLOUD_LOGGING_ONLY
